
ุงูููุฑุฉ ูุนุงูุง ูุงูุช ูู ุงูุฑุงูุชุงุจ ุฏู [account takeover 1](https://medium.com/@mohabmohamed999pp/full-account-takeover-via-unauthorized-password-reset-e0e465f57207)


ููู ุจูุนูู ุฑูููู ุนูู ุงููููุน ุจุงุณุชุฎุฏุงู Burp Suiteุ ููู Endpoint ูุซูุฑุฉ ููุงูุชูุงู:
```HTTP
GET /accounts/manage-users-data HTTP/2
```
ูู ุงู response ุ ูุงุญุธ ุงููุชุบูุฑุงุช ุงูุชุงููุฉ:
```HTTP
"showResetPassword": false,
"showModifyEmails": false
```
* ูุฐู ุงูููู ุชุนูู ุฃู ุฎูุงุฑุงุช **`reset password function and change email function`** ูุนุทูุฉ ูุฏูุฑู ุงููุธููู ุงูุญุงูู.  
* ุจุฏุฃ ุงูุดู ูู ุฃู ุชุนุฏูู ูุฐู ุงูููู ูุฏ ููููู ูู ุชูุนูู ูุฐู ุงูุฎูุงุฑุงุช.

ุงุณุชุฎุฏู **Match & Replace** ูู Burp Suite ูุชุนุฏูู ุงูููู ุฅูู:
```HTTP
"showResetPassword": true,
"showModifyEmails": true
```
๐ข ุจุนุฏ ุชุญุฏูุซ ุงูุตูุญุฉุ ุธูุฑุช ูู **ุฎูุงุฑุชุงู ุฌุฏูุฏุชุงู** ูู ุงููุงุฌูุฉ:

1. **ุชุนุฏูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู** ูุฃู ุนุถู ูู ุงููุฑูู.
2. **ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ** ูุฃู ูุณุชุฎุฏู.

๐น ุจุฏุฃ ูู ุงุฎุชุจุงุฑ ุงูุซุบุฑุฉ ููุนุฑูุฉ ูุฏู ุชุฃุซูุฑูุง.

---

#### **ุงูุฎุทูุฉ 2: ุชุฌุฑุจุฉ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ ูุฃุญุฏ ุฃุนุถุงุก ุงููุฑูู**

1. ุงุณุชุฎุฏู ุงูุฎูุงุฑ ุงูุฌุฏูุฏ **"ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ"** ูุฃุญุฏ ุฃุนุถุงุก ุงููุฑูู.
2. ุชููู ุงุณุชุฌุงุจุฉ **200 OK** ูุน **ุฑุงุจุท ุตุงูุญ ูุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ**.
3. ูุงู ุจุชุบููุฑ ูููุฉ ุงููุฑูุฑ ูุณุฌู ุงูุฏุฎูู ุจูุฌุงุญ ุฅูู ุญุณุงุจ ุฒูููู ูู ุงููุฑูู.

โ ูุฐุง ุฃูุฏ ุฃู ุจุฅููุงูู ุงูุชุญูู ูู ุญุณุงุจุงุช ุงููุฑููุ ููู ูุงุฐุง ุนู ุงูุญุณุงุจุงุช ุฎุงุฑุฌ ุงููุฑููุ

---

#### **ุงูุฎุทูุฉ 3: ุชุฌุฑุจุฉ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ ูุฃู ูุณุชุฎุฏู**

ุนูุฏ ุงุนุชุฑุงุถ ุทูุจ **ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ**ุ ูุงุญุธ:
```JSON
{
  "userId": 9438867,
  "resetAccessKey": false
}
```
๐น ูุงุญุธ ุฃู ุงููุธุงู ูุณุชุฎุฏู **ุฃุฑูุงููุง ุชุณูุณููุฉ (Sequential IDs) ูููุณุชุฎุฏููู**.  
๐น ูุงู ุจุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ ููุฌุฏ ุฃู ูุนุฑูู (User ID) ูู `9438868`ุ ููุง ูุนูู ุฃู ุงููุธุงู **ูุฒูุฏ ุงูุฃุฑูุงู ุจุชุฑุชูุจ ุชุตุงุนุฏู**.

๐ **ุณุคุงู ููู:** ูุงุฐุง ูู ุบููุฑ ุฑูู `userId` ูู ุงูุทูุจ ุฅูู ุฃู ุฑูู ุขุฎุฑุ

---

#### **ุงูุฎุทูุฉ 4: ุงุณุชุบูุงู ุงูุซุบุฑุฉ ุนูู ุฃู ูุณุชุฎุฏู**

๐น ูุงู ุจุชุนุฏูู ุงูุทูุจ ููุดูู **ูุนุฑูู ูุณุชุฎุฏู ุขุฎุฑ ุบูุฑ ุชุงุจุน ููุฑููู**:
```JSON
{
  "userId": 9438868,
  "resetAccessKey": false
}
```
๐ **ุงููุชูุฌุฉ:**  
๐ข **ุงุณุชุฌุงุจุฉ 200 OK** ูุน ุฑุงุจุท ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ูุฑูุฑ ุตุงูุญ!  
๐ข ูุงู ุจุงุณุชุฎุฏุงู ุงูุฑุงุจุทุ ูุถุน ูููุฉ ูุฑูุฑ ุฌุฏูุฏุฉุ ูุณุฌู ุงูุฏุฎูู ุฅูู ุญุณุงุจ ุงูุถุญูุฉ ุจูุฌุงุญ.

**ุจุฐููุ ุฃุซุจุช ุฃู ุจุฅููุงูู ุงูุณูุทุฑุฉ ุนูู ุฃู ุญุณุงุจ ุฏุงุฎู ุงููุธุงู!**

---

### **3. ุงูุชุฃุซูุฑ (Impact)**

๐ ูุฐู ุงูุซุบุฑุฉ ุฎุทูุฑุฉ ูุฃููุง ุชุณูุญ ููููุงุฌู ุจู:

- โ **ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ ูุฃู ูุณุชุฎุฏู**ุ ูููุณ ููุท ุฃุนุถุงุก ุงููุฑูู.
- โ **ุงูุงุณุชููุงุก ุนูู ุญุณุงุจุงุช ุฐุงุช ุตูุงุญูุงุช ุนุงููุฉ**ุ ูุซู ูุฏุฑุงุก ุงููุธุงู (Admin).
- โ **ุงูุณูุทุฑุฉ ุนูู ููุงุฑุฏ ุญุณุงุณุฉ ูู ุงููุคุณุณุฉ**.

ุฅุฐุง ุงุณุชูุบูุช ูุฐู ุงูุซุบุฑุฉุ ูููู ุฃู ุชุคุฏู ุฅูู:

- ๐น ููู ุงููุณุชุฎุฏููู ุงูุดุฑุนููู ุฎุงุฑุฌ ุญุณุงุจุงุชูู.
- ๐น ุณุฑูุฉ ุงูุจูุงูุงุช ุงูุณุฑูุฉ.
- ๐น ุชุนุทูู ุงููุฑู ูุงููุคุณุณุงุช ุจุงููุงูู.

---

### **4. ุงูุฅุจูุงุบ ูุงูุฅุตูุงุญ (Reporting & Fix)**

โ ุฃุจูุบ **Mohab Mohamed** ูุฑูู ุฃูุงู **Target.com** ุนุจุฑ ุจุฑูุงูุฌ ููุงูุขุช ุงูุซุบุฑุงุช **HackerOne**.  
โ ุงููุฑูู ุฃุฏุฑู ุฎุทูุฑุฉ ุงููุดููุฉ ูุฃุตูุญูุง ุจุณุฑุนุฉ.  
โ ุชู ุชุตููู ุงูุซุบุฑุฉ ูู **ุญุฑุฌุฉ (Critical) ุจุชูููู 9.1 CVSS**.  
โ ุญุตู ุงูุจุงุญุซ ุนูู ููุงูุฃุฉ ูุงููุฉ ูุจูุฑุฉ ๐.

### **ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ (Lessons Learned)**

๐น **ุงูุฑุจุท ุจูู ุงููุณุชุฎุฏู ูุงูุฌูุณุฉ (User Session Binding)** ููู ูููุน ูุฐุง ุงูููุน ูู ุงููุฌูุงุช.  
๐น **ุนุฏู ุงูุงุนุชูุงุฏ ุนูู ุงููุนุฑูุงุช ุงูุชุณูุณููุฉ (Sequential IDs)** ูู ุนูููุงุช ุญุณุงุณุฉ.  
๐น **ุชุญูู ุฏุงุฆููุง ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู ูู ุงูุฎุงุฏู (Server-Side Authorization).**  
๐น **ูุฑุงุฌุนุฉ ุงูุฃููุงุฏ ุงูุฃูููุฉ ูุงูู API Endpoints ุจุงุณุชูุฑุงุฑ ูููุน ุงูุชุณุฑุจ ุบูุฑ ุงูููุตูุฏ ูููุธุงุฆู ุงููุฎููุฉ.**
