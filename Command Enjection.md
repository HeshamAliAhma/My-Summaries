

### **. ูุนูู ุฃู Command Enjection ุ**

ุซุบุฑุฉ **Command Injection** ุจุชุญุตู ููุง ุชุทุจูู ููุจ ูุณูุญ ูููุณุชุฎุฏู ุฅูู ูุฏุฎู **ุฃูุงูุฑ ูุธุงู ุงูุชุดุบูู** ูููุถู ูุดุบููุง ูู ุบูุฑ ูุง ูุนูู ุฃู ุชุญูู ูู ุงููุฏุฎูุงุช. ุฏู ูุนูุงู ุฅู ุฃู ุญุฏ ููุฏุฑ ูุฏุฎู ุฃูุงูุฑ ุชุชุญูู ูู ุงูุณูุฑูุฑ ุฃู ุชุณุฑูุจ ุจูุงูุงุช ุญุณุงุณุฉ ุฃู ุญุชู ุชุฏููุฑ ุงููุธุงู ุจุงููุงูู.



### **. ุฅุฒุงู ุจุชุญุตู ุงูุซุบุฑุฉุ**

ููู ูุฐุง ุณุจุจ ูุฎูู ุงูุซุบุฑุฉ ุฏู ุชุญุตูุ ุฃูููู:

- ุฅู ุงูุชุทุจูู ูููู ุจูุนุชูุฏ ุนูู **ูุฏุฎูุงุช ุงููุณุชุฎุฏู ุจุดูู ูุจุงุดุฑ** ูู ุบูุฑ ูุง ูููุชุฑูุง ุฃู ูุชุฃูุฏ ุฅููุง ุณูููุฉ.
- ุงุณุชุฎุฏุงู **ุฏูุงู ุฎุทูุฑุฉ** ุฒู:
    - `system()`ุ `exec()`ุ `shell_exec()` ูู PHP
    - `os.system()`ุ `subprocess.run()` ูู Python
    - `Runtime.getRuntime().exec()` ูู Java
- ุนุฏู ูุฌูุฏ **ุตูุงุญูุงุช ูุญุฏูุฏุฉ** ูููุณุชุฎุฏู ุงููู ุจูุดุบู ุงูุชุทุจููุ ูุฏู ูููู ูุณูุญ ูู ูุดุบูู ุฃูุงูุฑ ูุฏููุฑุฉ.





### **. ุงุณุชุบูุงู ุงูุซุบุฑุฉ (ุฅุฒุงู ุงููุฎุชุฑู ุจูุณุชุบููุงุ)**

ุงูููุงุฌู ุจูุญุงูู ูุฏุฎู ุฃูุงูุฑ ุชูููุฐูุฉ ูู ุฃู ูุฏุฎู ูุชุตู ุจุฃูุงูุฑ ูุธุงู ุงูุชุดุบููุ ุฒู:  
โ **ุงุณุชุฎุฏุงู ููุงุตู ููุทููุฉ ุนุดุงู ูุถูู ุฃูุฑ ุฌุฏูุฏ:**

```c
ping 127.0.0.1; cat /etc/passwd
```

โ **ุงุณุชุบูุงู ุฑููุฒ ุฒู `&&`, `|`, `;`, `` ` ``, `$()` ูุชุดุบูู ุฃูุงูุฑ ูุชุนุฏุฏุฉ:**

```c
ls -la && whoami
```
โ **ุชูููุฐ ุฃูุงูุฑ ุจุดูู ุบูุฑ ูุจุงุดุฑ ูู ุฎูุงู ุซุบุฑุงุช ุฏุงุฎู ุงูุชุทุจูู ููุณู.**

### **. ุฃู ุงูุฑููุฒ ุงููู ูููู ูุณุชุบููุง ููุณุชุฎุฏููุง ุ**

| **Injection Operator** | **Injection Character** | **URL-Encoded Character** | **Executed Command**                       |
| ---------------------- | ----------------------- | ------------------------- | ------------------------------------------ |
| Semicolon              | `;`                     | `%3b`                     | Both                                       |
| New Line               | `\n`                    | `%0a`                     | Both                                       |
| Background             | `&`                     | `%26`                     | Both (second output generally shown first) |
| Pipe                   | `\|`                    | `%7c`                     | Both (only second output is shown)         |
| AND                    | `&&`                    | `%26%26`                  | Both (only if first succeeds)              |
| OR                     | `\|`                    | `%7c%7c`                  | Second (only if first fails)               |
| Sub-Shell              | ` `` `                  | `%60%60`                  | Both (Linux-only)                          |
| Sub-Shell              | `$()`                   | `%24%28%29`               | Both (Linux-only)                          |
### **. ุฃูุซูุฉ ุนูููุฉ**

#### **ูุซุงู ูู PHP:**

ูู ุนูุฏู ุณูุฑูุจุช ุจุณูุท ูุฏู:

```php
<?php  
$user_input = $_GET['cmd'];  
$output = shell_exec("echo " . $user_input);  
echo "<pre>$output</pre>";  
?>
```
ุงูููุฑูุถ ุงูููุฏ ุฏู ุจูุงุฎุฏ ูุฏุฎู ูู ุงููุณุชุฎุฏู ููุทุจุนูุ ููู ูู ุญุฏ ุฏุฎู:
```c
whoami; ls -la
```
ููุชู ุชูููุฐ **ุงูุฃูุฑูู ูุน ุจุนุถ**ุ ูุงูููุงุฌู ูููุฏุฑ ูุนุฑู ุงุณู ุงููุณุชุฎุฏู ุงููู ุดุบุงู ุนูู ุงูุณูุฑูุฑ ูููุงู ูุดูู ูู ุงููููุงุช ุงูููุฌูุฏุฉ ูู ุงูููุงู ุงูุญุงูู! ๐ฑ

#### **ูุซุงู ูู Python:**

```c
import os  
user_input = input("Enter command: ")  
os.system("echo " + user_input)
```
ูู ุงููุณุชุฎุฏู ูุชุจ:
```c
whoami && cat /etc/passwd
```
ููุชููุฐ ุงูุฃูุฑูู ูุฏู ุฎุทุฑ ุฌุฏูุงุ ูุฃูู ูููู ูุณุฑูุจ ุจูุงูุงุช ุญุณุงุณุฉ.

### **. ุฅุฒุงู ูุญูู ููุณูุง ูู Command Injectionุ**

๐น **ูุชุงุฎุฏุด ุงููุฏุฎูุงุช ุฒู ูุง ูู!**  
ูุงุฒู ุฃู ูุฏุฎู ุจูุชู ุงุณุชุฎุฏุงูู ูู ุชูููุฐ ุฃูุงูุฑ ุงููุธุงู ูุชููุชุฑ ูููุณ ุฌุฏูุงุ ูุชููุน ุงูุฑููุฒ ุงูุฎุทูุฑุฉ ุฒู `;`, `&&`, `|`, `` ` ``, `$()`.

๐น **ุงุณุชุฎุฏู ุฏูุงู ุขููุฉ** ุฒู:

- `escapeshellcmd()` ู `escapeshellarg()` ูู PHP.
- `shlex.quote()` ูู Python.

๐น **ูุชุดุบููุด ุงูุฃูุงูุฑ ุจุดูู ูุจุงุดุฑ!**  
ุญุงูู ุชุชุฌูุจ ุชูููุฐ ุฃูุงูุฑ ุงููุธุงู ุฃุณุงุณูุงุ ููู ูุถุทุฑ ุงุณุชุฎุฏู ุทุฑู ุฃูุซุฑ ุฃูุงููุง ุฒู `subprocess.run()` ูู Python ูุน **ูุงุฆูุฉ ุจูุถุงุก ุจุงูุฃูุงูุฑ ุงููุณููุญ ุจููุง ุจุณ**.

๐น **ุญุฏุฏ ุงูุตูุงุญูุงุช!**  
ูุชุดุบููุด ุงูุชุทุจูู ุจุตูุงุญูุงุช ุงูู `root`ุ ูุฎูู ููู ุฎุฏูุฉ ุญุณุงุจ ูุณุชุฎุฏู ุจุตูุงุญูุงุช ูุญุฏูุฏุฉ.

๐น **ุงุนุฒู ุงูุชุทุจูู ูู ุจูุฆุฉ ุขููุฉ**  
ูู ุงูุชุทุจูู ุจูุชุนุงูู ูุน ุฃูุงูุฑ ูุธุงู ุงูุชุดุบููุ ุดุบููู ุฌูุง **Container** ุฒู **Docker** ุนุดุงู ุชุนุฒู ุชุฃุซูุฑ ุงูุงุฎุชุฑุงู.


----
**ุฃุฏุงุฉ ุงู `Burp Suite`  ูุงููุฉ ุฌุฏุง ุงูู ุชุฎุชุจุฑ ุงูุซุบุฑุฉ ุฏู**

### ูุตุงุฏุฑ ุชุฑุงุฌุนููุง ูุงูุช ุจุชุฐุงูุฑ ุ
- https://book.hacktricks.wiki/en/pentesting-web/command-injection.html
- https://portswigger.net/web-security/os-command-injection
- https://youtu.be/K5wFmDSKkSQ?si=vjGfP5Kd9gS9M2Yo